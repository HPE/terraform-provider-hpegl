---
page_title: "hpegl_metal_host Resource - terraform-provider-hpegl"
subcategory: "metal"
description: |-
  Provides Host resource. This allows Metal Host creation, deletion and update.
---
# hpegl_metal_host (Resource)

Provides Host resource. This allows Metal Host creation, deletion and update.

## Example Usage

```terraform
# (C) Copyright 2020-2022 Hewlett Packard Enterprise Development LP

provider "hpegl" {
  metal {
    gl_token = false
  }
}

variable "location" {
  default = "USA:Central:V2DCC01"
}

resource "hpegl_metal_volume" "iscsi_volume" {
  name        = "iscsi-volume"
  size        = 5
  shareable   = true
  flavor      = "Fast"
  location    = var.location
  description = "Terraform shareable volume"
}

resource "hpegl_metal_host" "terra_host" {
  count              = 1
  name               = "tformed-${count.index}"
  image              = "ubuntu@18.04-20201102"
  machine_size       = "Medium System"
  ssh                = [hpegl_metal_ssh_key.newssh_1.id]
  networks           = ["Public", "Storage-Client"]
  network_route      = "Public"
  location           = var.location
  description        = "Hello from Terraform"
  volume_attachments = [hpegl_metal_volume.iscsi_volume.id]
}

# Example of Host creation with implicit dependencies
resource "hpegl_metal_ssh_key" "newssh_1" {
  name       = "newssh_1"
  public_key = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCv03o//GEQ9/6eI1qZleyBbSndg0n5AkcKVnf5D4fEjwkWrtSIJEnROqJddEAn2XYALAk9x1AcB4Nue3q4tDG17VeK3ODo0+9Dx0LYqUTawnFWmo4X80QKr658Jmt7Enmnk5x2IrUDcNwAzALVellkBbwq7QbYUu1swSycNlNhSfGizqo/lQCNIHXyeRQ8oJxOuZkbiturXHZL389blIrTeUo53xmwE1TolVS8QzZRN8ve1GjFvpC5dl6orzi6LXDcrDcbZaxlrW+YQqyaipFRAw1DyTalrfpqxtq/Y9+Elz5xgCnUaepHN6ha/k81wtI2rySHga6pMOcJKlxaRS5OfzdrWh7oi2tEAaiq2y3pTr9hROQ2OGcMNU5gxbVU2ymeXdHVsAHMCmyKvQe0g0/fJzmNA/excogFCWDN7Spy9s2V39IbEKttyXjD/dpave7re9eFzYHA1CBEnNjMuvJj0H4tnpAETdQ6UbnjbE4JYn5eKGvnJ2w1JTfSdMK8nMcxqo4HfHWuLFuntCV9GAlWIVIvJn1pYisY8kEOtN5w6QrLTfsei96/TfssAsfhrDrVtgcgNU3EvZlC6Uaaly7D0ISFeufsxkPswu+jGNUJvGEqDiqvt05lSEZWS5viR/TOROTlicaGN9dhez/fqHcj5cnuoK1pmibK5GT7/Yf1Gw== user1@quattronetworks.com"
}

resource "hpegl_metal_network" "newpnet_1" {
  name        = "newpnet_1"
  description = "New private network 1 description"
  location    = var.location
  ip_pool {
    name          = "npool"
    description   = "New IP pool description"
    ip_ver        = "IPv4"
    base_ip       = "10.0.0.0"
    netmask       = "/24"
    default_route = "10.0.0.1"
    sources {
      base_ip = "10.0.0.3"
      count   = 10
    }
    dns      = ["10.0.0.50"]
    proxy    = "https://10.0.0.60"
    no_proxy = "10.0.0.5"
    ntp      = ["10.0.0.80"]
  }
}

resource "hpegl_metal_host" "terra_host_new_ssh" {
  count            = 2
  name             = "tformed-newssh-${count.index}"
  image            = "ubuntu@18.04-20201102"
  machine_size     = "Medium System"
  ssh              = [hpegl_metal_ssh_key.newssh_1.id]
  networks         = ["Public", hpegl_metal_network.newpnet_1.name]
  network_route    = "Public"
  network_untagged = hpegl_metal_network.newpnet_1.name
  location         = var.location
  description      = "Hello from Terraform"
  labels           = { "ServiceType" = "BMaaS" }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `image` (String) A specific flavor and version in the form of flavor@version, eg 'ubuntu@18.04'.
- `location` (String) The location of where the machine will be provisioned, of the form 'country:region:centre', eg 'USA:Texas:AUSL2'.
- `machine_size` (String) Some generic sizing information for the machine like 'Small', 'Very Large'.
- `name` (String) Any friendly name to identify the host that will become the OS hostname in lower case.
- `networks` (List of String) List of network name e.g. ['Public', 'Private'].
- `ssh` (List of String) A list of SSH keys that will be pushed to the host.

### Optional

- `allocated_ips` (List of String) List of pre-allocated IP addresses in one-to-one correspondance wth Networks.
- `description` (String) A wordy description of the machine and purpose.
- `initiator_name` (String) The iSCSI initiator name for this host.
- `labels` (Map of String) map of label name to label value for this host
- `network_route` (String) Network selected for the default route
- `network_untagged` (String) Untagged network
- `user_data` (String) Any yaml compliant string that will be merged into cloud-init for this host.
- `volume_attachments` (List of String) List of existing volume IDs
- `volume_infos` (Block Set) Information about volumes attached to this host. (see [below for nested schema](#nestedblock--volume_infos))

### Read-Only

- `chap_secret` (String) The iSCSI CHAP secret for this host.
- `chap_user` (String) The iSCSI CHAP name for this host.
- `connections` (Map of String) A map of network connections and assigned IP addreses, eg {'Private':'10.83.0.17'}.
- `id` (String) The ID of this resource.
- `location_id` (String) UUID of the location
- `machine_size_id` (String) Machine size ID
- `network_ids` (List of String) List of network UUIDs.
- `network_route_id` (String) Network ID of the default route
- `network_untagged_id` (String) Untagged network ID
- `portal_comm_okay` (Boolean) The current portal communication state of the host
- `power_state` (String) The current power state of the host
- `ssh_ids` (List of String)
- `state` (String) The current state of the host
- `sub_state` (String) The current state of the deployment

<a id="nestedblock--volume_infos"></a>
### Nested Schema for `volume_infos`

Required:

- `name` (String) A friendly name of the volume attached.

Read-Only:

- `discovery_ip` (String) iSCSI Discovery IP.
- `id` (String) The ID the volume attached.
- `target_iqn` (String) iSCSI Target IQN.


